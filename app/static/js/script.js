document.addEventListener("DOMContentLoaded",function(){const processForm=document.getElementById("processForm");const processVideo=document.getElementById("processVideo");const subT_SelecVid=document.getElementById("subT-SelecVid");const subT_VidDisp=document.getElementById("subT-VidDisp")
  const spinner=document.getElementById("spinner");const progressMessage=document.getElementById("progressMessage");const rubricasContainer=document.getElementById("rubricasContainer");const videoList=document.getElementById("videoList");function showSpinner(message){spinner.style.display="block";progressMessage.textContent=message;uploadForm.style.display="none";processVideo.style.display="none";videoList.style.display="none";subT_SelecVid.style.display="none";subT_VidDisp.style.display="none"}
  function hideSpinner(){spinner.style.display="none";uploadForm.style.display="block";processForm.style.display="block";videoList.style.display="block";subT_SelecVid.style.display="block";subT_VidDisp.style.display="block";processVideo.style.display="block"}
  uploadForm.addEventListener("submit",function(event){event.preventDefault();const formData=new FormData(uploadForm);showSpinner("Cargando video...");fetch("/upload-video/",{method:"POST",body:formData,}).then(response=>{if(response.ok){setTimeout(()=>{hideSpinner();window.location.href="/"},1000)}else{console.error("Error al cargar el video.");hideSpinner()}}).catch(error=>{console.error("Error:",error);hideSpinner()})});processForm.addEventListener("submit",function(event){event.preventDefault();const formData=new FormData(processForm);const videoFile=formData.get("video_file");const socket=new WebSocket("ws://localhost:8000/ws/progress");socket.onopen=function(){console.log("WebSocket conectado");showSpinner(`Procesando el video: ${videoFile}...`)};socket.onmessage=function(event){const message=event.data;progressMessage.textContent=message};socket.onclose=function(){console.log("WebSocket cerrado");hideSpinner()};socket.onerror=function(error){console.log("Error en WebSocket: ",error);hideSpinner()};socket.onmessage=function(event){if(event.data==="Procesamiento completado."){hideSpinner();window.location.href="/results"}};fetch("/process-video/",{method:"POST",body:formData,}).then(response=>response.text()).then(result=>{rubricasContainer.innerHTML=result;hideSpinner()}).catch(error=>{console.error("Error:",error);hideSpinner()})})})